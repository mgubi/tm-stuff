(()=>{var e={69:e=>{let t=0;const s=e=>null!==e&&"object"==typeof e,r=e=>{void 0===e.attrs&&(e.attrs={}),void 0===e.events&&(e.events={}),void 0===e.children&&(e.children=[])},n=e=>Array.isArray(e)?e:[e],o=()=>document.createComment("");let i=[];const a={replaceChild:()=>{}},c=(e,t,s)=>{for(const r of Object.keys(e)){const o=n(e[r]),i=n(t[r]||[]);for(const e of o)i.includes(e)||"function"!=typeof e||s(r,e)}},l=(e,n,d)=>{const h=t=>{e&&e!==t&&i.push([2,e,t]),e=t};if(t++,n!==d)if(null===d)h(o());else if("string"==typeof d||"number"==typeof d)"string"==typeof n||"number"==typeof n?e.data=d:h(document.createTextNode(d));else if(void 0!==d.appendChild)h(d);else{(void 0===e||!s(n)||n&&void 0!==n.appendChild||n.tag!==d.tag)&&(n={tag:null},h(document.createElement(d.tag))),r(n),r(d);for(const t of Object.keys(d.attrs)){const s=n.attrs[t],r=d.attrs[t];if("class"===t){const t=r;Array.isArray(t)?e.className=t.join(" "):e.className=t}else if("style"===t){const t=s||{},n=r;for(const s of Object.keys(n))n[s]!==t[s]&&(e.style[s]=n[s]);for(const s of Object.keys(t))void 0===n[s]&&(e.style[s]="")}else t in e?(e[t]!==r||void 0===s&&s!==r)&&(e[t]=r):s!==r&&e.setAttribute(t,r)}for(const t of Object.keys(n.attrs))void 0===d.attrs[t]&&(t in e?e[t]=null:e.removeAttribute(t));c(d.events,n.events,((t,s)=>{e.addEventListener(t,s)})),c(n.events,d.events,((t,s)=>{e.removeEventListener(t,s)}));const t=n.children,o=d.children,a=t.length,u=o.length;if(u+a>0){const s=n._nodes||[],r=a<u?a:u;let c=0;for(;c<r;c++)t[c]!==o[c]&&(s[c]=l(s[c],t[c],o[c]));if(a<u)for(;c<u;c++){const t=l(void 0,void 0,o[c]);i.push([0,e,t]),s.push(t)}else{for(;c<a;c++)i.push([1,e,s[c]]);s.splice(u,a-u)}d._nodes=s}}return 0==--t&&function(){const e=i.length;for(let t=0;t<e;t++){const e=i[t],s=e[0];if(1===s)e[1].removeChild(e[2]);else if(2===s){const t=e[1],s=o(),r=t.parentNode;null!==r?(r.replaceChild(s,t),e[1]=s,e[3]=r):e[3]=a}}for(let t=0;t<e;t++){const e=i[t],s=e[0];0===s?e[1].appendChild(e[2]):2===s&&e[3].replaceChild(e[2],e[1])}i=[]}(),e};class d{constructor(...e){this.jdom=void 0,this.node=void 0,this.event={source:null,handler:()=>{}},this.init(...e),void 0===this.node&&this.render()}static from(e){return class extends d{init(...e){this.args=e}compose(){return e(...this.args)}}}init(){}get record(){return this.event.source}bind(e,t){if(this.unbind(),!(e instanceof y))throw new Error(`cannot bind to ${e}, which is not an instance of Evented.`);this.event={source:e,handler:t},e.addHandler(t)}unbind(){this.record&&this.record.removeHandler(this.event.handler),this.event={source:null,handler:()=>{}}}remove(){this.unbind()}compose(){return null}preprocess(e){return e}render(e){e=e||this.record&&this.record.summarize();const t=this.preprocess(this.compose(e),e);if(void 0===t)throw new Error(this.constructor.name+".compose() returned undefined.");try{this.node=l(this.node,this.jdom,t)}catch(e){console.error("rendering error.",e)}return this.jdom=t}}const h=new Set;let u;const m=new WeakMap,f=(e,t)=>e+"{"+t+"}",p=(e,t)=>{let s=[],r="";for(const n of Object.keys(t)){const o=t[n];if("@"===n[0])n.startsWith("@media")?s.push(f(n,p(e,o).join(""))):s.push(f(n,p("",o).join("")));else if("object"==typeof o){const t=n.split(",");for(const r of t)if(r.includes("&")){const t=r.replace(/&/g,e);s=s.concat(p(t,o))}else s=s.concat(p(e+" "+r,o))}else r+=n+":"+o+";"}return r&&s.unshift(f(e,r)),s},v=e=>class extends e{styles(){return{}}preprocess(e,t){return s(e)&&(e.attrs=e.attrs||{},e.attrs.class=n(e.attrs.class||[]),e.attrs.class.push((e=>{const t=(e=>{if(!m.has(e)){const t=JSON.stringify(e);let s=t.length,r=1989;for(;s;)r=13*r^t.charCodeAt(--s);m.set(e,"_torus"+(r>>>0))}return m.get(e)})(e);let s=0;if(!h.has(t)){u||(()=>{const e=document.createElement("style");e.setAttribute("data-torus",""),document.head.appendChild(e),u=e.sheet})();const r=p("."+t,e);for(const e of r)u.insertRule(e,s++);h.add(t)}return t})(this.styles(t)))),e}};class g extends d{get itemClass(){return d}init(e,...t){this.store=e,this.items=new Map,this.filterFn=null,this.itemData=t,this.bind(this.store,(()=>this.itemsChanged()))}itemsChanged(){const e=this.store.summarize(),t=this.items;for(const s of t.keys())e.includes(s)||(t.get(s).remove(),t.delete(s));for(const s of e)t.has(s)||t.set(s,new this.itemClass(s,(()=>this.store.remove(s)),...this.itemData));let s=[...t.entries()];null!==this.filterFn&&(s=s.filter((e=>this.filterFn(e[0])))),s.sort(((t,s)=>e.indexOf(t[0])-e.indexOf(s[0]))),this.items=new Map(s),this.render()}filter(e){this.filterFn=e,this.itemsChanged()}unfilter(){this.filterFn=null,this.itemsChanged()}get components(){return[...this]}get nodes(){return this.components.map((e=>e.node))}[Symbol.iterator](){return this.items.values()}remove(){super.remove();for(const e of this.items.values())e.remove()}compose(){return{tag:"ul",children:this.nodes}}}class y{constructor(){this.handlers=new Set}summarize(){}emitEvent(){const e=this.summarize();for(const t of this.handlers)t(e)}addHandler(e){this.handlers.add(e),e(this.summarize())}removeHandler(e){this.handlers.delete(e)}}class b extends y{constructor(e,t={}){super(),s(e)&&(t=e,e=null),this.id=e,this.data=t}update(e){Object.assign(this.data,e),this.emitEvent()}get(e){return this.data[e]}summarize(){return Object.assign({id:this.id},this.data)}serialize(){return this.summarize()}}class w extends y{constructor(e=[]){super(),this.reset(e)}get recordClass(){return b}get comparator(){return null}create(e,t){return this.add(new this.recordClass(e,t))}add(e){return this.records.add(e),this.emitEvent(),e}remove(e){return this.records.delete(e),this.emitEvent(),e}[Symbol.iterator](){return this.records.values()}find(e){for(const t of this.records)if(t.id===e)return t;return null}reset(e){this.records=new Set(e),this.emitEvent()}summarize(){return[...this.records].map((e=>[this.comparator?this.comparator(e):null,e])).sort(((e,t)=>e[0]<t[0]?-1:e[0]>t[0]?1:0)).map((e=>e[1]))}serialize(){return this.summarize().map((e=>e.serialize()))}}const C=e=>{let t;const s=[];for(;null!==t;)if(t=/:\w+/.exec(e),t){const r=t[0];s.push(r.substr(1)),e=e.replace(r,"(.+)")}return[new RegExp(e),s]},x={render:l,Component:d,Styled:v,StyledComponent:v(d),List:g,ListOf:e=>class extends g{get itemClass(){return e}},Record:b,Store:w,StoreOf:e=>class extends w{get recordClass(){return e}},Router:class extends y{constructor(e){super(),this.routes=Object.entries(e).map((([e,t])=>[e,...C(t)])),this.lastMatch=["",null],this._cb=()=>this.route(location.pathname),window.addEventListener("popstate",this._cb),this._cb()}summarize(){return this.lastMatch}go(e,{replace:t=!1}={}){window.location.pathname!==e&&(t?history.replaceState(null,document.title,e):history.pushState(null,document.title,e),this.route(e))}route(e){for(const[t,s,r]of this.routes){const n=s.exec(e);if(null!==n){const e={},s=n.slice(1);r.forEach(((t,r)=>e[t]=s[r])),this.lastMatch=[t,e];break}}this.emitEvent()}remove(){window.removeEventListener("popstate",this._cb)}}};"object"==typeof window&&(window.Torus=x),e.exports&&(e.exports=x)}},t={};!function s(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}(69)})();